<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Test Application Logic</title>
    <script src="../app/applicationLogic.js"></script>
</head>
<body>
    <hr>
    <h1>Login</h1>
    <form name="signIn">
        <label for="username">Username:</label>
        <input type="text" name="username">
        <label for="password">Password:</label>
        <input type="password" name="password">

        <input type="button" value="Sign In" onClick="login(
            document.signIn.username.value, 
            document.signIn.password.value
        )">
    </form>
    <button onClick="getUser()">Check User Signed In</button>
    <button onClick="logout()">Sign Out</button>
    <p id="userDetails"></p>
    <hr>

    <h1>Calendar</h1>
    <form name="calendarItems">
        <label for="calendarItemID">Calendar Item ID:</label>
        <input type="text" name="calendarItemID">
        <label for="title">Title:</label>
        <input type="text" name="title">
        <label for="startDate">Start Time:</label>
        <input type="date" name="startDate">
        <input type="time" name="startTime">
        <label for="endDate">End Time:</label>
        <input type="date" name="endDate">
        <input type="time" name="endTime">
        <input type="button" value="Add Item" onClick="addCalendarItem(
            document.calendarItems.title.value,
            document.calendarItems.startDate.value,
            document.calendarItems.startTime.value,
            document.calendarItems.endDate.value,
            document.calendarItems.endTime.value,
        )">
        <input type="button" value="Update Item" onClick="updateCalendarItem(
            document.calendarItems.calendarItemID.value,
            document.calendarItems.title.value,
            document.calendarItems.startDate.value,
            document.calendarItems.startTime.value,
            document.calendarItems.endDate.value,
            document.calendarItems.endTime.value,
        )">
        <input type="button" value="Remove Item" onClick="removeCalendarItem(
            document.calendarItems.calendarItemID.value
        )">
    </form>
    <button onClick="getCalendarItems()">Get Calendar Items</button>
    <p id="calendarItems"></p>
    <hr>

    <h1>Weekly Schedule</h1>
    <form name="scheduleItems">
        <label for="sheduleItemID">Schedule Item ID:</label>
        <input type="text" name="scheduleItemID">
        <label for="title">Title:</label>
        <input type="text" name="title">
        <label for="category">Category:</label>
        <input type="text" name="category">
        <label for="startTime">Start Time:</label>
        <input type="text" name="startTime">
        <label for="endTime">End Time:</label>
        <input type="text" name="endTime">
        <input type="button" value="Add Item" onClick="addScheduleItem(
            document.scheduleItems.title.value,
            document.scheduleItems.category.value,
            document.scheduleItems.startTime.value,
            document.scheduleItems.endTime.value,
        )">
        <input type="button" value="Update Item" onClick="updateScheduleItem(
            document.scheduleItems.scheduleItemID.value,
            document.scheduleItems.title.value,
            document.scheduleItems.category.value,
            document.scheduleItems.startTime.value,
            document.scheduleItems.endTime.value,
        )">
        <input type="button" value="Remove Item" onClick="removeScheduleItem(
            document.scheduleItems.scheduleItemID.value
        )">
    </form>
    <button onClick="getScheduleItems()">Get Schedule Items</button>
    <p id="scheduleItems"></p>
    <hr>

    <h1>Task List</h1>
    <form name="tasks">
        <label for="taskID">Task ID:</label>
        <input type="text" name="taskID">
        <label for="title">Title:</label>
        <input type="text" name="title">
        <label for="priority">Priority:</label>
        <input type="text" name="priority">
        <label for="estimatedTime">Estimated Time:</label>
        <input type="text" name="estimatedTime">
        <label for="startDate">Start Time:</label>
        <input type="date" name="startDate">
        <input type="time" name="startTime">
        <input type="button" value="Add Item" onClick="addTask(
            document.tasks.title.value,
            document.tasks.priority.value,
            document.tasks.estimatedTime.value
        )">
        <input type="button" value="Update Item" onClick="updateTask(
            document.tasks.taskID.value,    
            document.tasks.title.value,
            document.tasks.priority.value,
            document.tasks.estimatedTime.value,
            document.tasks.startDate.value,
            document.tasks.startTime.value
        )">
        <input type="button" value="Remove Item" onClick="removeTask(
            document.tasks.taskID.value
        )">
    </form>
    <button onClick="getTasks()">Get Tasks</button>
    <p id="tasks"></p>
    <hr>

    <h1>Get Data</h1>
    <!-- <button onClick="getTimes('2019-09-02','2019-09-08', 10)">Get Available Times</button>
    <p id="availableTimes"></p> -->
    <button onClick="getWeekData('2019-09-02','2019-09-08')">Get Week Data</button>
    <p id="weekData"></p>
    <hr>

    <script>
        // UI Scripts
        let getUser = () => {
            let user = getCookie();
            let output = user ? user.username + " " + user.password : "No user logged in";
            document.querySelector("#userDetails").innerHTML = output;
        }

        let getCalendarItems = async () => {
            let data = await getAllCalendarItems();
            if (!data)
                return; 
            let output = "";
            for (let i of data)
                output += `<p>${i.calendarItemID} - ${i.title}</p>`;
            document.querySelector("#calendarItems").innerHTML = output;
        }

        let getScheduleItems = async () => {
            let data = await getAllScheduleItems();
            if (!data)
                return; 
            let output = "";
            for (let i of data)
                output += `<p>${i.scheduleItemID} - ${i.title}</p>`;
            document.querySelector("#scheduleItems").innerHTML = output;
        }

        let getTasks = async () => {
            let data = await getAllTasks();
            if (!data)
                return; 
            let output = "";
            for (let i of data)
                output += `<p>${i.taskID} - ${i.title}</p>`;
            document.querySelector("#tasks").innerHTML = output;
        }

        // let getTimes = async (startTime, endTime, estimatedTime) => {
        //     let data = await getThisWeeksSchedule(startTime, endTime);
        //     let startDate = new Date(startTime);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
        //     let endDate = new Date(endTime);
        //     let currentDate = startDate;
        //     while (currentDate <= endDate) {
        //         let items = [];
        //         for (let i of data.calendarItems) {
        //             if (i.startTime.split('T')[0] == currentDate)
        //                 items.push(i)
        //         }
        //         for (let i of data.scheduleItems)
        //             output += `<p>s - ${i.scheduleItemID} - ${i.title} - ${i.startTime}</p>`;
        //         for (let i of data.tasks)
        //             output += `<p>t - ${i.taskID} - ${i.title} - ${i.startTime}</p>`;
        //     }
        // }

        let getWeekData = async (startTime, endTime) => {
            let data = await getThisWeeksSchedule(startTime, endTime);
            if (!data)
                return;
            let output = "";
            for (let i of data.calendarItems)
                output += `<p>c - ${i.calendarItemID} - ${i.title} - ${i.startTime}</p>`;
            for (let i of data.scheduleItems)
                output += `<p>s - ${i.scheduleItemID} - ${i.title} - ${i.startTime}</p>`;
            for (let i of data.tasks)
                output += `<p>t - ${i.taskID} - ${i.title} - ${i.startTime}</p>`;
            document.querySelector("#weekData").innerHTML = output;
        }
    </script>
</body>
</html>